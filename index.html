<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMASHERS Badminton Tournament 2025</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>SMASHERS Badminton Tournament 2025</h1>
    <p>Get ready for an electrifying tournament experience!</p>
  </header>

  <section class="countdown-section">
    <div class="countdown-timer-group">
      <h2>🏆 Tournament is ON. Its time for finals - 11 th July</h2>
      <h3>50+registrations , 30+ teams across categories and 160+ matches</h3>
      <h4>Not Participating? You can still be with us as spectator</h4>
    </div>
  </section>
  <section class="champions-corner">
    <h2>🏆 Champions Corner 🏆</h2>
    <h3>Meet the tournament champions</h3>
    
    <div class="champions-row">
      <div class="champion-card">
        <img src="womens_doubles.jpg" alt="Smashers Tournament- Womens Doubles Champions">
        <h3>Pooja N & Pranali</h3>
        <p>Smashers Tournament- Womens Doubles</p>
      </div>

      <div class="champion-card">
        <img src="mens_advanced_doubles.jpg" alt="Smashers Tournament- Mens Advanced Doubles Champions">
        <h3>To be announced......</h3>
        <p>Smashers Tournament- Mens Advanced Doubles</p>
      </div>

      <div class="champion-card">
        <img src="mens_advanced_doubles.jpg" alt="Smashers Tournament- Mens Beginner Doubles Champions">
        <h3>To be announced.....</h3>
        <p>Smashers Tournament- Mens Beginner Doubles</p>
      </div>

      <div class="champion-card">
        <img src="Mixed_doubles.jpeg" alt="Smashers Tournament- Mixed Doubles Champions">
        <h3>To be announced.....</h3>
        <p>Smashers Tournament- Mixed Doubles</p>
      </div>

      </div>
  </section>

  <div class="flyer-and-categories">
    <!-- <div class="flyer">
      <img id="tournament-flyer" src="flyer2.png" alt="Tournament Flyer" onerror="this.src='https://via.placeholder.com/400x300?text=Tournament+Flyer';">
    </div> -->

    <section class="category-selection-section">
      <h2>🏅 Tournament Category Selection</h2>
      <p>Select your category to get detailed fixtures and scores</p>
      <div class="category-buttons">
        <a href="mens-beginner-doubles.html" class="category">👥 Mens Beginner Doubles</a>
        <a href="mens-advanced-doubles.html" class="category">🏆 Mens Advanced Doubles</a>
        <a href="womens-doubles.html" class="category">👭 Womens Doubles</a>
        <a href="mixed-doubles.html" class="category">👫 Mixed Doubles</a>
      </div>
    </section>
  </div>
  <section class="live-scores-fixtures">
    <section>
      <h2>🏆 Live Matches</h2>
      <input type="text" id="live-match-team-filter" class="team-filter-input" placeholder="Filter by team name..." onkeyup="filterTable('live-matches', 'live-scores-table', this.value, 'liveScore')">
      <div id="live-matches">Loading live scores...</div>
    </section>
    <section>
      <h2>🗓️ Upcoming Fixtures</h2>
      <input type="text" id="upcoming-fixtures-team-filter" class="team-filter-input" placeholder="Filter by team name..." onkeyup="filterTable('upcoming-fixtures', 'fixtures-table', this.value, 'fixture')">
      <div id="upcoming-fixtures">Loading tournament fixtures...</div>
    </section>
  </section>

  </section> <section class="prizes-section">
    <h2>🏆 Prizes & Rewards 🏆</h2>
    <p>Celebrating excellence and participation in the SMASHERS Tournament 2025!</p>

    <div class="prizes-grid">
        <div class="prize-category winner-prizes">
            <h3>🥇 Winner's Circle</h3>
            <ul>
                <li>Shiny Winner's Cups for champions</li>
                <li>Exclusive 3 Free games with SMASHERS (valid until Dec'25) for each winner (worth €12) (Use link for voucher)</li>
                <li>A special prize</li>
                <li>Bragging rights and eternal glory!</li>
            </ul>
        </div>

        <div class="prize-category runner-prizes">
            <h3>🥈 Runner-Up Rewards</h3>
            <ul>
                <li>Exclusive 2 Free games with SMASHERS (valid until Dec'25) for each runners-up (worth €8) (Use link for voucher)</li></li>
                <li>A special prize</li>
                <li>Recognition and awesome experience</li>
            </ul>
        </div>

        <div class="prize-category registration-prizes">
            <h3>🎁 Registration Perks</h3>
            <ul>
                <li>One Free Game day (worth €4) during summer break with SMASHERS on Registration (Use link for voucher)</li>
                <li>Here you go </li>
                <li>Easy access to future tournament registration</li>
                <li>Loads of fun and entertainment</li>
            </ul>
        </div>
    </div>
    <p class="mt-8 text-gray-600">
      <strong>Claim your registration and prizes voucher here:</strong> <a href="voucher.html" class="text-blue-500 hover:underline font-semibold">Generate Your Voucher!</a>
    </p>
  </section>

  <section class="tournament-info-registration-contact">
    <h2>📋 Tournament Information</h2>
    <ul>
      <li><strong>Registration:</strong> Every individual needs to register separately</li>
      <li><strong>Location:</strong> Slagbaai 14, 1317 AC, Almere</li>
      <li><strong>Match Start Time:</strong> 8:40 PM onwards</li>
      <li><strong>Shuttle Used:</strong> Mavis 600</li>
    </ul>

    <h3>📅 Tournament Schedule</h3>
    <ul>
      <li><strong>7th July:</strong> Women's Doubles league, Semi - Finals + Men's Beginner Doubles League</li>
      <li><strong>8th July:</strong> Men's Advanced Doubles (League)</li>
      <li><strong>9th July:</strong> Mixed Doubles (League)</li>
      <li><strong>11th July:</strong> Finals Day :  (Men's Advanced + Mixed Doubles) - Quarters + Semi + Final , (Men's Advanced + Womens Doubles): Final </li>
    </ul>

    <h3>📜 Tournament Rules</h3>
    <ul>
        <li><strong>General Rules:</strong> All matches will be played according to BWF (Badminton World Federation) rules, unless otherwise specified.</li>
        <li><strong>Scoring:</strong> Every match will be 1 set of 21 points rally scoring upto max 30 points post which the match will be a tie.</li>
        <li><strong>Tie breakers:</strong> Net score will be used as tie breaker i.e (total points won - total points lost).If there is still a tie breaker that will be resolved with a 11 point match</li>
        <li><strong>Defaults:</strong> Teams/players not present at their scheduled match time will forfeit the match after a 10-minute grace period and opponent team will get a walkover.</li>
        <li><strong>Disputes:</strong> All on-court disputes will be resolved by the designated court referee/organizer. Tournament organizer's decision is final.</li>
        <li><strong>Dress Code:</strong> Ensure to wear non-marking indoor badminton shoes .</li>
        <li><strong>Cleanliness:</strong> Ensure to keep premises clean at all times and use designated dustbins .</li>
        <li><strong>Conduct:</strong> Players are expected to exhibit good sportsmanship and respect towards opponents, officials, and fellow participants.</li>
        </ul>
    <hr>

    <hr>

    <h3>📞 Contact Information</h3>
    <ul>
      <li><strong>Tournament Organizer:</strong> Gourav</li>
      <li><strong>WhatsApp:</strong> +91 70224 62728</li>
      <li><strong>Available for:</strong> queries, partnerships, and tournament updates</li>
    </ul>

    <hr>

    <h3>📝 Registration Details</h3>
    <ul>
      <li><strong>Solo Registration:</strong> Register individually - partner mapped by us if not available</li>
      <li><strong>Individual Entry:</strong> Each person must register separately</li>
      <li><strong>Deadline:</strong> July 4th, 2025</li>
      <li><strong>Fees:</strong> €12 per person for 1 category and €15 for 2 categories</li>
      <li><strong>Payment:</strong> Via tikkie. Present in google form</li>
    </ul>
    <a href="#" class="button">Register Now!</a>
    <a href="#faq" class="button">Have questions? Check out our FAQ</a>
  </section>


  <section id="faq" class="full-width-section">
    <h2>❓ Frequently Asked Questions</h2>
    <div class="faq-item">
      <details>
        <summary>Q: Do I need a partner to register?</summary>
        <p>A: No, you can register individually. We will help pair you with a partner if needed, or you can register with a friend.</p>
      </details>
    </div>
    <div class="faq-item">
      <details>
        <summary>Q: How will I know my match schedule?</summary>
        <p>A: The full schedule will be published on this website a few days before the tournament. Live updates will be available on the 'Live Matches' section.</p>
      </details>
    </div>
    <div class="faq-item">
      <details>
        <summary>Q: What shuttlecocks will be used?</summary>
        <p>A: We will be using Mavis 600 shuttlecocks for all matches.</p>
      </details>
    </div>
    <div class="faq-item">
      <details>
        <summary>Q: What are the prizes for winners?</summary>
        <p>A: Attractive prizes and trophies await the champions and runners-up in each category!</p>
      </details>
    </div>
  </section>

  <footer>
    <p>© 2025 SMASHERS Badminton Tournament. All rights reserved.</p>
  </footer>

  <script>
const webAppUrl = 'https://script.google.com/macros/s/AKfycbzwzWVhd0HCRjSFEEVhNgpdHQIA1HMbEj21ef3WdhR3641ZAf-0OLoD_Jmeb1oY5NqvCA/exec';

// Countdown Timer (unchanged)
// function startCountdown() {
//   const targetDate = new Date('2025-07-07T20:30:00+02:00');
//   const daysEl = document.getElementById('days');
//   const hoursEl = document.getElementById('hours');
//   const minutesEl = document.getElementById('minutes');
//   const secondsEl = document.getElementById('seconds');

//   function updateTimer() {
//     const now = new Date();
//     const timeLeft = targetDate - now;
//     if (timeLeft <= 0) {
//       daysEl.textContent = '0';
//       hoursEl.textContent = '0';
//       minutesEl.textContent = '0';
//       secondsEl.textContent = '0';
//       document.querySelector('.countdown-timer-group h2').textContent = '🏆 Tournament has started!';
//       return;
//     }
//     const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
//     const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
//     const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
//     const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
//     daysEl.textContent = days.toString().padStart(2, '0');
//     hoursEl.textContent = hours.toString().padStart(2, '0');
//     minutesEl.textContent = minutes.toString().padStart(2, '0');
//     secondsEl.textContent = seconds.toString().padStart(2, '0');
//   }
//   updateTimer();
//   setInterval(updateTimer, 1000);
// }

// Helper for sorting stages (reused from category pages)
const stageOrder = {
    'Final': 0,
    'Semi-Finals': 1,
    'Quarter-Finals': 2,
    'League': 3
};

function sortStages(stageA, stageB) {
    const orderA = stageOrder[stageA] !== undefined ? stageOrder[stageA] : 99; // 99 for unknown stages (put last)
    const orderB = stageOrder[stageB] !== undefined ? stageOrder[stageB] : 99;
    return orderA - orderB;
}

async function loadData() {
  try {
    const liveResponse = await fetch(`${webAppUrl}?sheet=Livescores`, { method: 'GET', mode: 'cors' });
    const liveData = await liveResponse.json();
    if (!liveData.data || !Array.isArray(liveData.data.liveMatches)) {
      throw new Error('Invalid live matches data structure');
    }

    const fixturesResponse = await fetch(`${webAppUrl}?sheet=Fixtures`, { method: 'GET', mode: 'cors' });
    const fixturesData = await fixturesResponse.json();
    if (!fixturesData.data || !Array.isArray(fixturesData.data.fixtures)) {
      throw new Error('Invalid fixtures data structure');
    }
    
    // Initial render
    renderLiveScores(liveData.data.liveMatches);
    renderFixtures(fixturesData.data.fixtures);

  } catch (error) {
    console.error('Error loading data:', error);
    document.getElementById('live-matches').innerHTML = 'Failed to load live matches: ' + error.message;
    document.getElementById('upcoming-fixtures').innerHTML = 'Failed to load fixtures: ' + error.message;
  }
}

function renderLiveScores(matches) {
    const liveMatchesContainer = document.getElementById('live-matches');
    liveMatchesContainer.innerHTML = ''; // Clear existing content

    if (!matches || matches.length === 0) {
        liveMatchesContainer.innerHTML = '<p>No live or completed matches available.</p>';
        return;
    }

    // Filter out "Scheduled" matches
    let filteredMatches = matches.filter(match => match.Status !== 'Scheduled');

    // Sort: In Progress first, then Completed (by Match ID descending as fallback)
    filteredMatches.sort((a, b) => {
        if (a.Status === 'In Progress' && b.Status !== 'In Progress') return -1;
        if (a.Status !== 'In Progress' && b.Status === 'In Progress') return 1;
        // If both are 'Completed' or both 'In Progress', sort by Match ID descending
        return (b['CompletionTimestamp'] || '').localeCompare(a['CompletionTimestamp'] || '');
    });

    // Limit to top 12
    const top12Matches = filteredMatches.slice(0, 12);

    if (top12Matches.length === 0) {
        liveMatchesContainer.innerHTML = '<p>No live or completed matches to display in top 6.</p>';
        return;
    }

    // Group the top 12 matches by Category, then Group, then Stage
    const groupedData = top12Matches.reduce((acc, match) => {
        const category = match.Category || 'Unknown Category';
        const group = match.Group || 'No Group';
        const stage = match.Stage || 'Unknown Stage';

        if (!acc[category]) acc[category] = {};
        if (!acc[category][stage]) acc[category][stage] = {};
        if (!acc[category][stage][group]) acc[category][stage][group] = [];
        acc[category][stage][group].push(match);
        return acc;
    }, {});

    let htmlContent = '';
    Object.keys(groupedData).sort().forEach(category => {
        htmlContent += `<div class="live-scores-category-container"><h2>${category}</h2>`;
        console.log("Grouped_data",groupedData)
        Object.keys(groupedData[category]).sort(sortStages).forEach(stage => {
              const displaystage = `Stage: ${stage}`
              console.log("displaystage",displaystage)

              htmlContent += `<div class="live-scores-stage-container"><h3>${displaystage}</h3>`;
              Object.keys(groupedData[category][stage]).sort().forEach(group => {
                const displayGroup = group === 'No Group' || !group ? 'No Group' : `${group}`;
                console.log("displayGroup",displayGroup)

            
                htmlContent += `<div class="live-scores-group-container"><h4>${displayGroup}</h4>`;

                htmlContent += `
                    <div class="live-scores-table-container">
                        <table class="live-scores-table points-table">
                            <thead>
                                <tr>
                                    <th>Match ID</th>
                                    <th>Team 1</th>
                                    <th>Team 2</th>
                                    <th>Score</th>
                                    <th>Status</th>
                                    <th>Court</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${groupedData[category][stage][group].map(match => `
                                    <tr>
                                        <td>${match['Match ID'] || '-'}</td>
                                        <td>${match['Team 1'] || '-'}</td>
                                        <td>${match['Team 2'] || '-'}</td>
                                        <td>${match['Team 1 Score'] || '0'} - ${match['Team 2 Score'] || '0'}</td>
                                        <td>${match.Status || '-'}</td>
                                        <td>${match.Court || '-'}</td>
                                    </tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                htmlContent += `</div>`; // Close stage container
            });
            htmlContent += `</div>`; // Close group container
        });
        htmlContent += `</div>`; // Close category container
    });

    liveMatchesContainer.innerHTML = htmlContent;
}

function renderFixtures(fixtures) { // Parameter renamed to 'fixtures' for clarity
    const fixturesContainer = document.getElementById('upcoming-fixtures');
    fixturesContainer.innerHTML = ''; // Clear existing content

    if (!fixtures || fixtures.length === 0) {
        fixturesContainer.innerHTML = '<p>No upcoming fixtures available.</p>';
        return;
    }

    // Directly use the raw fixtures data
    let allFixtures = fixtures;

    // Filter to include only "Scheduled" matches
    let scheduledFixtures = allFixtures.filter(fixture => fixture.Status === 'Scheduled');

    // Sort by ascending order of time
    scheduledFixtures.sort((a, b) => {
        const dateA = new Date(`${a.Date} ${a.Time}`);
        const dateB = new Date(`${b.Date} ${b.Time}`);
        return dateA - dateB;
    });

    // Limit to top 12
    const top12Fixtures = scheduledFixtures.slice(0, 12);

    if (top12Fixtures.length === 0) {
        fixturesContainer.innerHTML = '<p>No upcoming fixtures to display in top 6.</p>';
        return;
    }

    // Group the top 6 fixtures by Category, then Group, then Stage
    const groupedData = top12Fixtures.reduce((acc, fixture) => {
        const category = fixture.Category || 'Unknown Category';
        const group = fixture.Group || 'No Group';
        const stage = fixture.Stage || 'Unknown Stage';

        if (!acc[category]) acc[category] = {};
        if (!acc[category][stage]) acc[category][stage] = {};
        if (!acc[category][stage][group]) acc[category][stage][group] = [];
        acc[category][stage][group].push(fixture);
        return acc;
    }, {});

    let htmlContent = '';
    Object.keys(groupedData).sort().forEach(category => {
        htmlContent += `<div class="fixtures-category-container"><h2>${category}</h2>`;
        Object.keys(groupedData[category]).sort(sortStages).forEach(stage => {
              const displaystage = `Stage: ${stage}`
              htmlContent += `<div class="fixtures-stage-container"><h3>${displaystage}</h3>`;
            Object.keys(groupedData[category][stage]).sort().forEach(group => {
                const displayGroup = group === 'No Group' || !group ? 'No Group' : `${group}`;
                htmlContent += `<div class="fixtures-group-container"><h4>${displayGroup}</h4>`;

                htmlContent += `
                    <div class="fixtures-table-container">
                        <table class="fixtures-table points-table">
                            <thead>
                                <tr>
                                    <th>Match ID</th>
                                    <th>Team 1</th>
                                    <th>Team 2</th>
                                    <th>Date</th>
                                    <th>Time</th>
                                    <th>Court</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${groupedData[category][stage][group].map(fixture => `
                                    <tr>
                                        <td>${fixture['Match ID'] || '-'}</td>
                                        <td>${fixture['Team 1'] || '-'}</td>
                                        <td>${fixture['Team 2'] || '-'}</td>
                                        <td>${fixture.Date || '-'}</td>
                                        <td>${fixture.Time || '-'}</td>
                                        <td>${fixture.Court || '-'}</td>
                                    </tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                htmlContent += `</div>`; // Close stage container
            });
            htmlContent += `</div>`; // Close group container
        });
        htmlContent += `</div>`; // Close category container
    });

    fixturesContainer.innerHTML = htmlContent;
}

// Filter function (reused from category pages)
function filterTable(tableContainerId, tableClass, filterValue, tableType) {
    var input, filter, table, tr, td1, td2, i, txtValue;
    input = filterValue;
    filter = input.toUpperCase();

    const tables = document.querySelectorAll(`#${tableContainerId} .${tableClass}`);
    if (tables.length === 0) {
        console.warn(`No tables found in #${tableContainerId} with class .${tableClass}`);
        return;
    }

    tables.forEach(table => {
        tr = table.getElementsByTagName("tr");
        // Start from 1 to skip the header row (assuming the first row is always header)
        for (i = 1; i < tr.length; i++) {
            if (tableType === 'liveScore') {
                td1 = tr[i].getElementsByTagName("td")[1]; // Team 1 (index 1 in 6-column table)
                td2 = tr[i].getElementsByTagName("td")[2]; // Team 2 (index 2 in 6-column table)
            } else if (tableType === 'fixture') {
                td1 = tr[i].getElementsByTagName("td")[1]; // Team 1 (index 1 in 6-column table)
                td2 = tr[i].getElementsByTagName("td")[2]; // Team 2 (index 2 in 6-column table)
            }
            
            if (td1 && td2) {
                txtValue = (td1.textContent || td1.innerText) + " " + (td2.textContent || td2.innerText);
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            } else if (td1) { // Fallback if only td1 is available (shouldn't happen for these tables)
                txtValue = td1.textContent || td1.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    });
}


// startCountdown();
loadData();
  </script>
</body>
</html>